[Sanity] in_ch=8 (2*C), F=256, Tseg=184. Batch sizes: mixture_2ft=(8, 8, 256, 184), cirm_2ft=(8, 2, 256, 184)
======================================================================================================================================================
Layer (type (var_name))                            Input Shape          Output Shape         Param #              Kernel Shape         Mult-Adds
======================================================================================================================================================
lmfcaNet (lmfcaNet)                                [1, 8, 256, 184]     [1, 2, 256, 184]     --                   --                   --
├─Sequential (firstblock)                          [1, 8, 256, 184]     [1, 48, 256, 184]    --                   --                   --
│    └─FCABlock (0)                                [1, 8, 256, 184]     [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (res1)                      [1, 8, 256, 184]     [1, 24, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 8, 256, 184]     [1, 24, 256, 184]    192                  [1, 1]               9,043,968
│    │    │    └─BatchNorm2d (1)                   [1, 24, 256, 184]    [1, 24, 256, 184]    48                   --                   48
│    │    │    └─ReLU6 (2)                         [1, 24, 256, 184]    [1, 24, 256, 184]    --                   --                   --
│    │    └─Sequential (res2)                      [1, 24, 256, 184]    [1, 24, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 24, 256, 184]    [1, 24, 256, 184]    216                  [3, 3]               10,174,464
│    │    │    └─BatchNorm2d (1)                   [1, 24, 256, 184]    [1, 24, 256, 184]    48                   --                   48
│    │    │    └─ReLU6 (2)                         [1, 24, 256, 184]    [1, 24, 256, 184]    --                   --                   --
│    │    └─FCA (attn)                             [1, 8, 256, 184]     [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Sequential (attn)                 [1, 8, 256, 184]     [1, 48, 128, 92]     1,152                --                   10,174,752
│    │    └─Sequential (FF)                        [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 48, 256, 184]    2,304                [1, 1]               108,527,616
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (shortcut)                  [1, 8, 256, 184]     [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 8, 256, 184]     [1, 8, 256, 184]     72                   [3, 3]               3,391,488
│    │    │    └─BatchNorm2d (1)                   [1, 8, 256, 184]     [1, 8, 256, 184]     16                   --                   16
│    │    │    └─Conv2d (2)                        [1, 8, 256, 184]     [1, 48, 256, 184]    384                  [1, 1]               18,087,936
│    │    │    └─BatchNorm2d (3)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    └─Sandglass (1)                               [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (dw1)                       [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 48, 256, 184]    432                  [3, 3]               20,348,928
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (pw_reduce)                 [1, 48, 256, 184]    [1, 24, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 24, 256, 184]    1,152                [1, 1]               54,263,808
│    │    │    └─BatchNorm2d (1)                   [1, 24, 256, 184]    [1, 24, 256, 184]    48                   --                   48
│    │    └─Sequential (pw_expand)                 [1, 24, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 24, 256, 184]    [1, 48, 256, 184]    1,152                [1, 1]               54,263,808
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (dw2)                       [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 48, 256, 184]    432                  [3, 3]               20,348,928
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
├─ModuleList (down_blocks)                         --                   --                   --                   --                   --
│    └─Sequential (0)                              [1, 48, 256, 184]    [1, 96, 128, 92]     --                   --                   --
│    │    └─FCABlock (0)                           [1, 48, 256, 184]    [1, 96, 256, 184]    --                   --                   --
│    │    │    └─Sequential (res1)                 [1, 48, 256, 184]    [1, 48, 256, 184]    2,400                --                   108,527,712
│    │    │    └─Sequential (res2)                 [1, 48, 256, 184]    [1, 48, 256, 184]    528                  --                   20,349,024
│    │    │    └─FCA (attn)                        [1, 48, 256, 184]    [1, 96, 256, 184]    6,144                --                   65,569,344
│    │    │    └─Sequential (FF)                   [1, 96, 256, 184]    [1, 96, 256, 184]    9,408                --                   434,110,656
│    │    │    └─Sequential (shortcut)             [1, 48, 256, 184]    [1, 96, 256, 184]    5,328                --                   237,404,448
│    │    └─Sandglass (1)                          [1, 96, 256, 184]    [1, 96, 256, 184]    --                   --                   --
│    │    │    └─Sequential (dw1)                  [1, 96, 256, 184]    [1, 96, 256, 184]    1,056                --                   40,698,048
│    │    │    └─Sequential (pw_reduce)            [1, 96, 256, 184]    [1, 48, 256, 184]    4,704                --                   217,055,328
│    │    │    └─Sequential (pw_expand)            [1, 48, 256, 184]    [1, 96, 256, 184]    4,800                --                   217,055,424
│    │    │    └─Sequential (dw2)                  [1, 96, 256, 184]    [1, 96, 256, 184]    1,056                --                   40,698,048
│    │    └─MaxPool2d (2)                          [1, 96, 256, 184]    [1, 96, 128, 92]     --                   2                    --
│    └─Sequential (1)                              [1, 96, 128, 92]     [1, 224, 64, 46]     --                   --                   --
│    │    └─FCABlock (0)                           [1, 96, 128, 92]     [1, 224, 128, 92]    --                   --                   --
│    │    │    └─Sequential (res1)                 [1, 96, 128, 92]     [1, 112, 128, 92]    10,976               --                   126,615,776
│    │    │    └─Sequential (res2)                 [1, 112, 128, 92]    [1, 112, 128, 92]    1,232                --                   11,870,432
│    │    │    └─FCA (attn)                        [1, 96, 128, 92]     [1, 224, 128, 92]    25,088               --                   69,903,680
│    │    │    └─Sequential (FF)                   [1, 224, 128, 92]    [1, 224, 128, 92]    50,624               --                   590,873,024
│    │    │    └─Sequential (shortcut)             [1, 96, 128, 92]     [1, 224, 128, 92]    23,008               --                   263,406,208
│    │    └─Sandglass (1)                          [1, 224, 128, 92]    [1, 224, 128, 92]    --                   --                   --
│    │    │    └─Sequential (dw1)                  [1, 224, 128, 92]    [1, 224, 128, 92]    2,464                --                   23,740,864
│    │    │    └─Sequential (pw_reduce)            [1, 224, 128, 92]    [1, 96, 128, 92]     21,696               --                   253,231,296
│    │    │    └─Sequential (pw_expand)            [1, 96, 128, 92]     [1, 224, 128, 92]    21,952               --                   253,231,552
│    │    │    └─Sequential (dw2)                  [1, 224, 128, 92]    [1, 224, 128, 92]    2,464                --                   23,740,864
│    │    └─MaxPool2d (2)                          [1, 224, 128, 92]    [1, 224, 64, 46]     --                   2                    --
│    └─Sequential (2)                              [1, 224, 64, 46]     [1, 480, 32, 23]     --                   --                   --
│    │    └─FCABlock (0)                           [1, 224, 64, 46]     [1, 480, 64, 46]     --                   --                   --
│    │    │    └─Sequential (res1)                 [1, 224, 64, 46]     [1, 240, 64, 46]     54,240               --                   158,269,920
│    │    │    └─Sequential (res2)                 [1, 240, 64, 46]     [1, 240, 64, 46]     2,640                --                   6,359,520
│    │    │    └─FCA (attn)                        [1, 224, 64, 46]     [1, 480, 64, 46]     115,200              --                   82,670,400
│    │    │    └─Sequential (FF)                   [1, 480, 64, 46]     [1, 480, 64, 46]     231,360              --                   678,298,560
│    │    │    └─Sequential (shortcut)             [1, 224, 64, 46]     [1, 480, 64, 46]     110,944              --                   322,475,392
│    │    └─Sandglass (1)                          [1, 480, 64, 46]     [1, 480, 64, 46]     --                   --                   --
│    │    │    └─Sequential (dw1)                  [1, 480, 64, 46]     [1, 480, 64, 46]     5,280                --                   12,719,040
│    │    │    └─Sequential (pw_reduce)            [1, 480, 64, 46]     [1, 224, 64, 46]     107,968              --                   316,539,328
│    │    │    └─Sequential (pw_expand)            [1, 224, 64, 46]     [1, 480, 64, 46]     108,480              --                   316,539,840
│    │    │    └─Sequential (dw2)                  [1, 480, 64, 46]     [1, 480, 64, 46]     5,280                --                   12,719,040
│    │    └─MaxPool2d (2)                          [1, 480, 64, 46]     [1, 480, 32, 23]     --                   2                    --
├─ModuleList (up_blocks)                           --                   --                   --                   --                   --
│    └─Sequential (0)                              [1, 480, 32, 23]     [1, 480, 32, 23]     --                   --                   --
│    │    └─Sandglass (0)                          [1, 480, 32, 23]     [1, 480, 32, 23]     --                   --                   --
│    │    │    └─Sequential (dw1)                  [1, 480, 32, 23]     [1, 480, 32, 23]     5,280                --                   3,180,480
│    │    │    └─Sequential (pw_reduce)            [1, 480, 32, 23]     [1, 224, 32, 23]     107,968              --                   79,135,168
│    │    │    └─Sequential (pw_expand)            [1, 224, 32, 23]     [1, 480, 32, 23]     108,480              --                   79,135,680
│    │    │    └─Sequential (dw2)                  [1, 480, 32, 23]     [1, 480, 32, 23]     5,280                --                   3,180,480
│    │    └─Sandglass (1)                          [1, 480, 32, 23]     [1, 480, 32, 23]     --                   --                   --
│    │    │    └─Sequential (dw1)                  [1, 480, 32, 23]     [1, 480, 32, 23]     5,280                --                   3,180,480
│    │    │    └─Sequential (pw_reduce)            [1, 480, 32, 23]     [1, 224, 32, 23]     107,968              --                   79,135,168
│    │    │    └─Sequential (pw_expand)            [1, 224, 32, 23]     [1, 480, 32, 23]     108,480              --                   79,135,680
│    │    │    └─Sequential (dw2)                  [1, 480, 32, 23]     [1, 480, 32, 23]     5,280                --                   3,180,480
│    └─Sequential (1)                              [1, 480, 32, 23]     [1, 224, 64, 46]     --                   --                   --
│    │    └─FCABlock (0)                           [1, 480, 32, 23]     [1, 224, 32, 23]     --                   --                   --
│    │    │    └─Sequential (res1)                 [1, 480, 32, 23]     [1, 112, 32, 23]     53,984               --                   39,567,584
│    │    │    └─Sequential (res2)                 [1, 112, 32, 23]     [1, 112, 32, 23]     1,232                --                   742,112
│    │    │    └─FCA (attn)                        [1, 480, 32, 23]     [1, 224, 32, 23]     111,104              --                   19,319,104
│    │    │    └─Sequential (FF)                   [1, 224, 32, 23]     [1, 224, 32, 23]     50,624               --                   36,929,984
│    │    │    └─Sequential (shortcut)             [1, 480, 32, 23]     [1, 224, 32, 23]     113,248              --                   82,315,648
│    │    └─Sandglass (1)                          [1, 224, 32, 23]     [1, 224, 32, 23]     --                   --                   --
│    │    │    └─Sequential (dw1)                  [1, 224, 32, 23]     [1, 224, 32, 23]     2,464                --                   1,484,224
│    │    │    └─Sequential (pw_reduce)            [1, 224, 32, 23]     [1, 96, 32, 23]      21,696               --                   15,827,136
│    │    │    └─Sequential (pw_expand)            [1, 96, 32, 23]      [1, 224, 32, 23]     21,952               --                   15,827,392
│    │    │    └─Sequential (dw2)                  [1, 224, 32, 23]     [1, 224, 32, 23]     2,464                --                   1,484,224
│    │    └─ConvTranspose2d (2)                    [1, 224, 32, 23]     [1, 224, 64, 46]     200,928              [2, 2]               591,532,032
│    └─Sequential (2)                              [1, 224, 64, 46]     [1, 96, 128, 92]     --                   --                   --
│    │    └─FCABlock (0)                           [1, 224, 64, 46]     [1, 96, 64, 46]      --                   --                   --
│    │    │    └─Sequential (res1)                 [1, 224, 64, 46]     [1, 48, 64, 46]      10,848               --                   31,653,984
│    │    │    └─Sequential (res2)                 [1, 48, 64, 46]      [1, 48, 64, 46]      528                  --                   1,271,904
│    │    │    └─FCA (attn)                        [1, 224, 64, 46]     [1, 96, 64, 46]      23,040               --                   16,534,080
│    │    │    └─Sequential (FF)                   [1, 96, 64, 46]      [1, 96, 64, 46]      9,408                --                   27,132,096
│    │    │    └─Sequential (shortcut)             [1, 224, 64, 46]     [1, 96, 64, 46]      24,160               --                   69,243,520
│    │    └─Sandglass (1)                          [1, 96, 64, 46]      [1, 96, 64, 46]      --                   --                   --
│    │    │    └─Sequential (dw1)                  [1, 96, 64, 46]      [1, 96, 64, 46]      1,056                --                   2,543,808
│    │    │    └─Sequential (pw_reduce)            [1, 96, 64, 46]      [1, 48, 64, 46]      4,704                --                   13,566,048
│    │    │    └─Sequential (pw_expand)            [1, 48, 64, 46]      [1, 96, 64, 46]      4,800                --                   13,566,144
│    │    │    └─Sequential (dw2)                  [1, 96, 64, 46]      [1, 96, 64, 46]      1,056                --                   2,543,808
│    │    └─ConvTranspose2d (2)                    [1, 96, 64, 46]      [1, 96, 128, 92]     36,960               [2, 2]               435,240,960
│    └─Sequential (3)                              [1, 96, 128, 92]     [1, 48, 256, 184]    --                   --                   --
│    │    └─FCABlock (0)                           [1, 96, 128, 92]     [1, 48, 128, 92]     --                   --                   --
│    │    │    └─Sequential (res1)                 [1, 96, 128, 92]     [1, 24, 128, 92]     2,352                --                   27,131,952
│    │    │    └─Sequential (res2)                 [1, 24, 128, 92]     [1, 24, 128, 92]     264                  --                   2,543,664
│    │    │    └─FCA (attn)                        [1, 96, 128, 92]     [1, 48, 128, 92]     5,376                --                   14,979,360
│    │    │    └─Sequential (FF)                   [1, 48, 128, 92]     [1, 48, 128, 92]     2,400                --                   27,132,000
│    │    │    └─Sequential (shortcut)             [1, 96, 128, 92]     [1, 48, 128, 92]     5,760                --                   64,438,560
│    │    └─Sandglass (1)                          [1, 48, 128, 92]     [1, 48, 128, 92]     --                   --                   --
│    │    │    └─Sequential (dw1)                  [1, 48, 128, 92]     [1, 48, 128, 92]     528                  --                   5,087,328
│    │    │    └─Sequential (pw_reduce)            [1, 48, 128, 92]     [1, 48, 128, 92]     2,400                --                   27,132,000
│    │    │    └─Sequential (pw_expand)            [1, 48, 128, 92]     [1, 48, 128, 92]     2,400                --                   27,132,000
│    │    │    └─Sequential (dw2)                  [1, 48, 128, 92]     [1, 48, 128, 92]     528                  --                   5,087,328
│    │    └─ConvTranspose2d (2)                    [1, 48, 128, 92]     [1, 48, 256, 184]    9,264                [2, 2]               436,371,456
├─Sequential (lastConv)                            [1, 48, 256, 184]    [1, 2, 256, 184]     --                   --                   --
│    └─Sandglass (0)                               [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (dw1)                       [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 48, 256, 184]    432                  [3, 3]               20,348,928
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (pw_reduce)                 [1, 48, 256, 184]    [1, 24, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 24, 256, 184]    1,152                [1, 1]               54,263,808
│    │    │    └─BatchNorm2d (1)                   [1, 24, 256, 184]    [1, 24, 256, 184]    48                   --                   48
│    │    └─Sequential (pw_expand)                 [1, 24, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 24, 256, 184]    [1, 48, 256, 184]    1,152                [1, 1]               54,263,808
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (dw2)                       [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 48, 256, 184]    432                  [3, 3]               20,348,928
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    └─Sandglass (1)                               [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (dw1)                       [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 48, 256, 184]    432                  [3, 3]               20,348,928
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (pw_reduce)                 [1, 48, 256, 184]    [1, 24, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 24, 256, 184]    1,152                [1, 1]               54,263,808
│    │    │    └─BatchNorm2d (1)                   [1, 24, 256, 184]    [1, 24, 256, 184]    48                   --                   48
│    │    └─Sequential (pw_expand)                 [1, 24, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 24, 256, 184]    [1, 48, 256, 184]    1,152                [1, 1]               54,263,808
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    └─Sequential (dw2)                       [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    │    │    └─Conv2d (0)                        [1, 48, 256, 184]    [1, 48, 256, 184]    432                  [3, 3]               20,348,928
│    │    │    └─BatchNorm2d (1)                   [1, 48, 256, 184]    [1, 48, 256, 184]    96                   --                   96
│    │    │    └─ReLU6 (2)                         [1, 48, 256, 184]    [1, 48, 256, 184]    --                   --                   --
│    └─Conv2d (2)                                  [1, 48, 256, 184]    [1, 2, 256, 184]     98                   [1, 1]               4,616,192
│    └─BatchNorm2d (3)                             [1, 2, 256, 184]     [1, 2, 256, 184]     4                    --                   4
│    └─Tanh (4)                                    [1, 2, 256, 184]     [1, 2, 256, 184]     --                   --                   --
======================================================================================================================================================
Total params: 2,133,102
Trainable params: 2,133,102
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 7.90
======================================================================================================================================================
Input size (MB): 1.51
Forward/backward pass size (MB): 1806.16
Params size (MB): 8.53
Estimated Total Size (MB): 1816.20
======================================================================================================================================================
Traceback (most recent call last):
  File "/data1/is156025/zb276885/LMFCA-Net/train.py", line 241, in <module>
    train(args)
  File "/data1/is156025/zb276885/LMFCA-Net/train.py", line 133, in train
    input()
KeyboardInterrupt
